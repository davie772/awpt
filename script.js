var J="work",Z="rest",w="break";class F extends EventTarget{#f=null;#H=[];#z=0;#$="work";#g=null;#q=null;constructor(H,g,f){super();this.#g=H,this.#H=g,this.#q=f}start(){if(this.#J(),this.#f!==null)clearInterval(this.#f);this.intervalId=setInterval(()=>{this.#J()},500)}#J(){this.#V()}#V(){let H=new Date,g=this.#z,f=this.#H[this.#z];if(this.#g<f.start&&H>=f.start){this.dispatchElapsed(f.start,"break"),this.#V();return}if(this.#g<f.end&&H>=f.end){if(this.dispatchElapsed(f.end,"rest"),this.#z<this.#H.length-1)this.#z+=1;this.#V();return}}getElapsed(H){return H-this.#g}dispatchElapsed(H,g){let f=new Date(Math.min(H.getTime(),this.#q.getTime())),z=this.getElapsed(f),Y=new M(z,this.#$);this.dispatchEvent(Y),this.#g=f,this.#$=g}}var V=(H,g)=>{let f=new Date;return f.setHours(H),f.setMinutes(g),f.setSeconds(0),f.setMilliseconds(0),f};class ${constructor(H,g){this.start=H,this.end=g}static fromStartAndDuration(H,g){let f=new Date(H.getTime()+g*60000);return new $(H,f)}}class M extends Event{#f;#H;constructor(H,g){super("time-passed");this.#f=H,this.#H=g}get elapsed(){return this.#f}get kind(){return this.#H}}var O=".green{color:green}.red{color:red}#button-section{flex-direction:column;gap:5em;display:flex}#normal-button{width:20em;height:20em}#rest-button{width:5em;height:5em;margin-left:5em}";var A="*,:before,:after,:host{box-sizing:border-box}*,:host{margin:0}";var P=new CSSStyleSheet;P.replaceSync(A);var W=new CSSStyleSheet;W.replaceSync(O);document.adoptedStyleSheets=[W];var G=(H,g)=>{let f=document.createElement("template");f.innerHTML=H;let z=new CSSStyleSheet;return z.replaceSync(g),[f,[P,z]]},N=(H,g,f)=>{let z=H.attachShadow({mode:"open"});return z.adoptedStyleSheets=f,z.appendChild(g.content.cloneNode(!0)),z};var _={};var b="<slot name=time></slot>h";var[E,o]=G(b,_);customElements.define("d-time-fmt",class extends HTMLElement{static observedAttributes=["ms"];constructor(){super();let H=N(this,E,o);this._dHeading=document.createElement("span"),this._dHeading.slot="time",this._dHeading.textContent="NO TIME",this.prepend(this._dHeading)}attributeChangedCallback(H,g,f){this._dHeading.textContent=`${(f/3600000).toFixed(2)}`}});document.addEventListener("keydown",(H)=>{if(H.key==="Enter"||H.keyCode===13)H.preventDefault(),H.stopPropagation()},!0);var j=document.getElementById("uph-goal"),Q=j.value,I=1/Q;j.addEventListener("input",(H)=>{Q=j.value,I=1/Q,X()});var d=document.getElementById("nt"),m=document.getElementById("rt"),r=document.getElementById("bt"),u=document.getElementById("uph"),c=document.getElementById("udev"),i=document.getElementById("units"),s=document.getElementById("ps"),U=document.getElementById("dev"),l=document.getElementById("normal-button"),a=document.getElementById("rest-button"),n=document.getElementById("problem-button");l.addEventListener("click",()=>{L+=1,X(),q.dispatchElapsed(new Date,J)});n.addEventListener("click",()=>{K+=1,X(),q.dispatchElapsed(new Date,J)});a.addEventListener("click",()=>{q.dispatchElapsed(new Date,Z)});var t=V(6,0),e=V(16,30),H0=[$.fromStartAndDuration(V(8,30),15),$.fromStartAndDuration(V(12,0),30),$.fromStartAndDuration(V(14,20),15)],q=new F(t,H0,e),C=0,h=0,D=0,L=0,K=0;q.addEventListener("time-passed",(H)=>{switch(console.log(`${H.kind} â€” ${(H.elapsed/3600000).toFixed(2)}h`),H.kind){case Z:h+=H.elapsed;break;case J:C+=H.elapsed;break;case w:D+=H.elapsed;break}});var x=(H)=>{if(H<0)return[`${H}`,"red"];return[`+${H}`,"green"]},X=()=>{d.setAttribute("ms",C),m.setAttribute("ms",h),r.setAttribute("ms",D),i.textContent=L;let H=(C+h)/3600000;console.log(`total: ${H.toFixed(2)}h`);let g=L/H;u.textContent=g.toFixed(2);let f=Q*H,z=L-f,[Y,R]=x(Math.round(z));c.className=R,c.textContent=Y;let S=I*z,[B,y]=x(S.toFixed(2));U.className=y,U.textContent=B,s.textContent=K,console.log()};q.addEventListener("time-passed",X);q.start();
